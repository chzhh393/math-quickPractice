<view class="container">
  <view class="header">
    <view class="back-button" bindtap="navigateBack">
      <view class="back-icon">â†</view>
      <view class="back-text">è¿”å›</view>
    </view>
    <view class="title">ä»»åŠ¡å­¦ä¹ æŠ¥å‘Š</view>
  </view>

  <view class="main-content">
    <block wx:if="{{loading}}">
      <view class="loading">åŠ è½½ä¸­...</view>
    </block>
    
    <block wx:elif="{{errorMessage}}">
      <view class="error-message">
        <view class="error-icon">âŒ</view>
        <view class="error-text">{{errorMessage}}</view>
      </view>
    </block>
    
    <block wx:elif="{{task}}">
      <view class="task-info">
        <view class="task-title">{{task.title}}</view>
        <view class="task-meta">
          <view class="task-status {{task.status === 'å·²å®Œæˆ' ? 'completed' : task.status === 'è¿›è¡Œä¸­' ? 'in-progress' : ''}}">
            {{task.status}}
          </view>
          <view class="task-date">åˆ›å»ºæ—¶é—´: {{formatTime(task.createTime)}}</view>
        </view>
      </view>
      
      <view class="report-summary">
        <view class="summary-title">å­¦ä¹ æ¦‚å†µ</view>
        <view class="summary-stats">
          <view class="stat-item">
            <view class="stat-value">{{problemCount}}</view>
            <view class="stat-label">é¢˜ç›®æ€»æ•°</view>
          </view>
          <view class="stat-item">
            <view class="stat-value">{{answeredCount}}</view>
            <view class="stat-label">å·²å›ç­”</view>
          </view>
          <view class="stat-item">
            <view class="stat-value">{{correctCount}}</view>
            <view class="stat-label">æ­£ç¡®æ•°</view>
          </view>
          <view class="stat-item">
            <view class="stat-value">{{correctRate}}%</view>
            <view class="stat-label">æ­£ç¡®ç‡</view>
          </view>
        </view>
      </view>
      
      <view class="problems-list">
        <view class="list-title">é¢˜ç›®è¯¦æƒ…</view>
        
        <block wx:for="{{problemsList}}" wx:key="key" wx:for-item="problem">
          <view class="problem-item" bindtap="viewProblemHistory" data-problem-key="{{problem.key}}">
            <view class="problem-header">
              <view class="problem-number">é¢˜ç›® {{problem.index + 1}}</view>
              <view class="problem-status {{problem.answered ? (problem.lastCorrect ? 'correct' : 'incorrect') : 'unanswered'}}">
                {{problem.answered ? (problem.lastCorrect ? 'æ­£ç¡®' : 'é”™è¯¯') : 'æœªä½œç­”'}}
              </view>
            </view>
            
            <view class="problem-content">{{problem.content}}</view>
            
            <view class="problem-stats">
              <view class="attempt-count">
                <text class="stat-label">å°è¯•æ¬¡æ•°:</text>
                <text class="stat-value">{{problem.attemptCount}}</text>
              </view>
              <view class="last-attempt-time" wx:if="{{problem.lastAttemptTime}}">
                <text class="stat-label">æœ€è¿‘ä½œç­”:</text>
                <text class="stat-value">{{formatTime(problem.lastAttemptTime)}}</text>
              </view>
            </view>
            
            <view class="view-detail">
              <text>æŸ¥çœ‹è¯¦æƒ…</text>
              <text class="arrow">></text>
            </view>
          </view>
        </block>
      </view>
    </block>
    
    <block wx:else>
      <view class="empty-report">
        <view class="empty-icon">ğŸ“Š</view>
        <view class="empty-text">æš‚æ— ä»»åŠ¡æŠ¥å‘Š</view>
      </view>
    </block>
  </view>
</view> 