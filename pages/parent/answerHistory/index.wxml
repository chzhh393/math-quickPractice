<view class="container">
  <view class="header">
    <view class="back-button" bindtap="navigateBack">
      <view class="back-icon">â†</view>
      <view class="back-text">è¿”å›</view>
    </view>
    <view class="title">ç­”é¢˜å†å²è®°å½•</view>
  </view>

  <view class="main-content">
    <block wx:if="{{loading}}">
      <view class="loading">åŠ è½½ä¸­...</view>
    </block>
    
    <block wx:elif="{{errorMessage}}">
      <view class="error-message">
        <view class="error-icon">âŒ</view>
        <view class="error-text">{{errorMessage}}</view>
      </view>
    </block>
    
    <block wx:elif="{{history && history.length > 0}}">
      <view class="problem-info">
        <view class="problem-title">é¢˜ç›®å†…å®¹</view>
        <view class="problem-content">{{problemContent}}</view>
      </view>
      
      <view class="history-list">
        <view class="history-title">ç­”é¢˜è®°å½• ({{history.length}}æ¬¡)</view>
        
        <block wx:for="{{history}}" wx:key="timestamp" wx:for-index="idx">
          <view class="history-item {{item.correct ? 'correct' : 'incorrect'}}">
            <view class="history-header">
              <view class="attempt-number">ç¬¬{{history.length - idx}}æ¬¡å°è¯•</view>
              <view class="attempt-time">{{formatTime(item.timestamp)}}</view>
              <view class="attempt-result">{{item.correct ? 'æ­£ç¡®' : 'é”™è¯¯'}}</view>
            </view>
            
            <view class="history-section">
              <view class="section-label">å­¦ç”Ÿè¡¨è¿°:</view>
              <view class="section-content">{{item.voiceText || 'æ— è®°å½•'}}</view>
            </view>
            
            <view class="history-section">
              <view class="section-label">AIåé¦ˆ:</view>
              <view class="section-content">{{item.feedback || 'æ— åé¦ˆ'}}</view>
            </view>
            
            <block wx:if="{{!item.correct && item.errorType}}">
              <view class="history-section">
                <view class="section-label">é”™è¯¯ç±»å‹:</view>
                <view class="section-content">{{item.errorType}}</view>
              </view>
            </block>
            
            <block wx:if="{{!item.correct && item.specificError}}">
              <view class="history-section">
                <view class="section-label">å…·ä½“é”™è¯¯:</view>
                <view class="section-content">{{item.specificError}}</view>
              </view>
            </block>
          </view>
        </block>
      </view>
    </block>
    
    <block wx:else>
      <view class="problem-info" wx:if="{{problemContent}}">
        <view class="problem-title">é¢˜ç›®å†…å®¹</view>
        <view class="problem-content">{{problemContent}}</view>
      </view>
      
      <view class="empty-history">
        <view class="empty-icon">ğŸ“</view>
        <view class="empty-text">æš‚æ— ç­”é¢˜è®°å½•</view>
        <view class="empty-subtext">å­¦ç”Ÿå°šæœªå›ç­”æ­¤é¢˜ç›®</view>
      </view>
    </block>
  </view>
</view> 

